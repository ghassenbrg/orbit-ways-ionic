<ion-header>
  <ion-toolbar>
    <ion-title>Orbit Ways</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="container-bg">
    <!-- Current Player & Score Display -->
    <div class="info-bar" [ngClass]="{ 'game-finished': matchDone }">
      <div class="info-item current-player">
        <!--
        <span class="label">Current Player:</span>
        <div
          class="player-indicator"
          [ngClass]="currentPlayer === 'B' ? 'player-black' : 'player-white'"
        ></div>
        <span
          class="player-label"
          [style]="{ color: currentPlayer === 'B' ? 'black' : 'white' }"
        >
          ({{ currentPlayer === 'B' ? 'Black' : 'White'}})
        </span>
        -->
        <!-- Show if it's MY turn or not -->
        <span
          *ngIf="myTurn; else noTurn"
          class="turn-label turn-active"
        >
          It's your turn!
        </span>
        <ng-template #noTurn>
          <span class="turn-label turn-waiting">
            Waiting...
          </span>
        </ng-template>
      </div>

      <hr />

      <div class="info-item">
        <span class="label" style="margin-right: 0 !important;">{{players.black === this.myUserId ? 'You': players.black}} (</span>
        <div class="score-indicator player-black"></div>
        <span class="label">) :</span>
        <span class="score">{{ score.B }}</span>
      </div>
      <div class="info-item">
        <span class="label" style="margin-right: 0 !important;">{{players.white === this.myUserId ? 'You': players.white}} (</span>
        <div class="score-indicator player-white"></div>
        <span class="label">) :</span>
        <span class="score">{{ score.W }}</span>
      </div>

      <hr />
    </div>

    <!-- Board Area -->
    <div class="board-container">
      <div class="board-grid" [class.ring-rotating]="isRotating">
        <div class="board-row" *ngFor="let row of board; let r = index">
          <div
            class="board-cell"
            *ngFor="let cell of row; let c = index"
            [ngClass]="{
              'cell-black': cell === 'B',
              'cell-white': cell === 'W'
            }"
            (click)="placeMarble(r, c)"
          ></div>
        </div>
      </div>
    </div>

    <!-- Result / Game Over for this Round -->
    <div class="result-board" *ngIf="gameOver && !matchDone">
      <div *ngIf="winner === 'B'" class="winner-panel black-winner">
        Black wins this round!!
      </div>
      <div *ngIf="winner === 'W'" class="winner-panel white-winner">
        White wins this round!!
      </div>
      <div *ngIf="winner === null" class="winner-panel tie-winner">
        Itâ€™s a tie !!
      </div>
      <button class="round-button" (click)="resetBoard(false)">
        Next Round !
      </button>
    </div>

    <!-- Match Done -->
    <div class="result-board match-done" *ngIf="matchDone">
      <div class="winner-panel final-winner" [ngClass]="{
        'black-winner': finalWinner === 'B',
        'white-winner': finalWinner === 'W'
      }">
        {{ finalWinner === 'B' ? players.black : players.white }} wins the match!!
      </div>
    </div>

    <!-- Full Reset Button -->
    <button class="reset-button" (click)="resetBoard(true)">
      Reset
    </button>
  </div>
</ion-content>
